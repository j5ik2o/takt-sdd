name: cc-sdd-design
description: SDD Phase 2 - 要件に基づく技術設計と発見ログを生成する
piece_config:
  provider_options:
    codex:
      network_access: true
    opencode:
      network_access: true
max_movements: 15
initial_movement: generate-design

policies:
  cc-sdd-design: ../facets/policies/cc-sdd-design.md

instructions:
  generate-design: ../facets/instructions/cc-sdd-generate-design.md

knowledge:
  cc-sdd-design-discovery: ../facets/knowledge/cc-sdd-design-discovery.md

report_formats:
  cc-sdd-design: ../facets/output-contracts/cc-sdd-design.md
  cc-sdd-research: ../facets/output-contracts/cc-sdd-research.md

movements:
  - name: generate-design
    edit: true
    persona: planner
    policy: cc-sdd-design
    knowledge:
      - architecture
      - cc-sdd-design-discovery
    allowed_tools:
      - Read
      - Glob
      - Grep
      - Write
      - Bash
      - WebSearch
      - WebFetch
    required_permission_mode: edit
    instruction: generate-design
    output_contracts:
      report:
        - name: design.md
          format: cc-sdd-design
        - name: research.md
          format: cc-sdd-research
    rules:
      - condition: 設計完了、発見記録あり
        next: COMPLETE
      - condition: 要件が見つからない、設計不可
        next: ABORT
        appendix: |
          原因:
          - {問題点}
