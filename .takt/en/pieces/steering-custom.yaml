name: steering-custom
description: Creates custom steering documents (API standards, test strategy, security, etc.)
max_movements: 10
initial_movement: detect

# --- Custom Facet Section Map ---
personas:
  steering-analyst: ../facets/personas/steering-analyst.md

policies:
  steering-principles: ../facets/policies/steering-principles.md

instructions:
  detect: ../facets/instructions/detect-steering-custom.md
  generate: ../facets/instructions/generate-steering-custom.md

knowledge:
  steering-custom-templates: ../facets/knowledge/steering-custom-templates.md

report_formats:
  steering-custom: ../facets/output-contracts/steering-custom.md

# --- Movement Definitions ---
movements:
  # ===== Target Detection =====
  - name: detect
    edit: false
    persona: steering-analyst
    allowed_tools:
      - Read
      - Glob
      - Grep
    instruction: detect
    rules:
      - condition: Target topic identified (template available or from scratch)
        next: generate
      - condition: Topic unclear, insufficient information
        next: ABORT
        appendix: |
          Items to clarify:
          - {unclear_point}

  # ===== Custom Steering Generation =====
  - name: generate
    edit: true
    persona: steering-analyst
    policy: steering-principles
    knowledge: steering-custom-templates
    allowed_tools:
      - Read
      - Glob
      - Grep
      - Write
      - Bash
    required_permission_mode: edit
    instruction: generate
    output_contracts:
      report:
        - name: steering-custom-report.md
          format: steering-custom
    rules:
      - condition: Custom steering file generated successfully
        next: COMPLETE
      - condition: Insufficient codebase information, unable to generate
        next: ABORT
        appendix: |
          Reason:
          - {issue}
